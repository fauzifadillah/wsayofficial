jQuery(function(e){"use strict";if("undefined"==typeof agenwebsite_woocommerce_jne_params)return!1;var t=agenwebsite_woocommerce_jne_params.debug,a={width:"100%",formatNoMatches:function(e){return agenwebsite_woocommerce_jne_params.i18n_no_matches},placeholderOption:"first"},n={width:"100%"};function i(){var a=e("<p />").attr("id","calc_shipping_kota_field").addClass("form-row form-row-wide").append("<span />").css("clear","both"),n=e("<select />").attr({name:"calc_shipping_kota",id:"calc_shipping_kota",placeholder:agenwebsite_woocommerce_jne_params.i18n_placeholder_kota});return n.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_placeholder_kecamatan+"</option>"),a.append(n),t&&console.log("JNE Shipping: Create field kota success"),a}e(document).ready(function(){if("cart"===agenwebsite_woocommerce_jne_params.page){if("ID"!=e("#calc_shipping_country").val())return!1;e(e("#calc_shipping_state").parent().parent()).after(i),e().select2?(t&&console.log("JNE Shipping: Change country and all script shipping state using select2"),e("select.country_to_state").select2(a),e("select#calc_shipping_state").select2(a)):e().chosen&&(t&&console.log("JNE Shipping: Change country and all script shipping state using chosen. Still using chosen?"),e("select.country_to_state").chosen(n),e("select#calc_shipping_state").chosen(n)),e("#calc_shipping_state").change()}"billing"!==agenwebsite_woocommerce_jne_params.page&&"shipping"!==agenwebsite_woocommerce_jne_params.page||(t&&console.log("JNE Shipping: params page billing and shipping call change()"),e("#billing_state, #shipping_state, #calc_shipping_state").change()),"checkout"===agenwebsite_woocommerce_jne_params.page&&(t&&console.log("JNE Shipping: params page checkout change()"),e("#billing_state, #shipping_state").change())}),e("body").bind("updated_shipping_method",function(){"cart"===agenwebsite_woocommerce_jne_params.page&&(e(e("#calc_shipping_state").parent().parent()).after(i),e().select2&&(e("select.country_to_state").select2(a),e("select#calc_shipping_state").select2(a)),e("#calc_shipping_state").change())}),e("body").on("change","#billing_state, #shipping_state, #calc_shipping_state",function(){var a,n,i,o=e("select.country_to_state, input.country_to_state").val(),c={action:"woocommerce_jne_shipping_get_kota",provinsi:e(this).find("option:selected").text(),_wpnonce:agenwebsite_woocommerce_jne_params._wpnonce},s=e(this).attr("id");switch(s){case"billing_state":a=e("#billing_kota"),n=e("#billing_city");break;case"shipping_state":a=e("#shipping_kota"),n=e("#shipping_city");break;case"calc_shipping_state":a=e("#calc_shipping_kota"),n=e("#calc_shipping_city");break;default:return!1}if(void 0!==n.attr("value")&&!1!==n.attr("value")&&n.attr("value").indexOf(",")>=0&&(i=n.attr("value").split(", ")[1]),"ID"===o){a.parent().show(),a.attr("disabled",!0),n.attr("disabled",!0),a.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_loading_data+"</option>");var l=a.find("option:eq(1)").val();e().select2?a.select2().select2("val",l):e().chosen&&a.val(l).trigger("chosen:updated"),n.is("select")&&(n.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_loading_data+"</option>"),e().select2?n.select2().select2("val",l):e().chosen&&n.val(l).trigger("chosen:updated")),t&&console.log("Request Data",s,c),e.post(agenwebsite_woocommerce_jne_params.ajax_url,c,function(e){t&&console.log("Response Data",s,e);var n="";if(e.constructor===Object||e.constructor===Array)for(var o=0;o<e.length;o++){var c=e[o],l="";c==i&&(l='selected="selected"'),n+='<option value="'+c+'" '+l+">"+c+"</option>"}a.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_placeholder_kota+"</option>"+n),a.removeAttr("disabled"),a.change()}).fail(function(e){t&&console.error(e),a.removeAttr("disabled"),a.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_placeholder_kota+"</option>"),n.removeAttr("disabled"),n.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_placeholder_kecamatan+"</option>")})}else a.change(),a.parent().hide()}),e("body").on("change","#billing_kota, #shipping_kota, #calc_shipping_kota",function(){var i,o,c,s=e("select.country_to_state, input.country_to_state").val(),l=e(this).closest("div").find("#billing_state option:selected, #shipping_state option:selected, #calc_shipping_state option:selected"),p=e(this).find("option:selected"),r={action:"woocommerce_jne_shipping_get_kecamatan",provinsi:l.text(),kota:p.text(),_wpnonce:agenwebsite_woocommerce_jne_params._wpnonce},_=agenwebsite_woocommerce_jne_params.i18n_placeholder_kecamatan,g=agenwebsite_woocommerce_jne_params.i18n_label_kecamatan,h=' <abbr class="required" title="'+agenwebsite_woocommerce_jne_params.i18n_required_text+'">*</abbr>';switch(e(this).attr("id")){case"billing_kota":i=e("#billing_city");break;case"shipping_kota":i=e("#shipping_city");break;case"calc_shipping_kota":i=e("#calc_shipping_city");break;default:return!1}if(void 0!==(o={name:i.attr("name"),id:i.attr("id"),placeholder:i.attr("placeholder"),label:i.parent().find("label"),value:i.attr("value")}).value&&!1!==o.value&&o.value.indexOf(",")>=0&&(c=o.value.split(", ")[0]),"ID"===s){if(o.label.html(g+h),i.attr("disabled",!0),i.is("select")){i.html('<option value="">'+agenwebsite_woocommerce_jne_params.i18n_loading_data+"</option>");var d=i.find("option:eq(1)").val();e().select2?i.select2().select2("val",d):e().chosen&&i.val(d).trigger("chosen:updated")}t&&console.log("Request Data",i,r),e.post(agenwebsite_woocommerce_jne_params.ajax_url,r,function(s){t&&console.log("Response Data",i,s);var l="";if(s.constructor===Object||s.constructor===Array)for(var r=0;r<s.length;r++){var g=s[r],h="";g===c&&(h='selected="selected"'),l+='<option value="'+g+", "+p.text()+'" '+h+">"+g+"</option>"}i.is("input")&&(i.replaceWith(e("<select />").attr({name:o.name,id:o.id,placeholder:_}).addClass("city_select")),i=e("#billing_kota, #shipping_kota, #calc_shipping_kota").closest("div").find("select#billing_city, select#shipping_city, select#calc_shipping_city")),i.html('<option value="">'+_+"</option>"+l),i.removeAttr("disabled"),e().select2?i.select2(a):e().chosen&&(i.chosen(n),i.trigger("chosen:updated"))}).fail(function(e){t&&console.error(e),i.html('<option value="">'+_+"</option>"),i.removeAttr("disabled")})}else i.is("select")&&("calc_shipping_city"!==o.id&&i.parent().show().find(".chosen-container, .select2-container").remove(),i.replaceWith('<input type="text" class="input-text" name="'+o.name+'" id="'+o.id+'" placeholder="'+o.placeholder+'" />'))}),e("body").on("change","select.country_to_state, input.country_to_state",function(){var o,c,s,l,p=e(this).val();switch(e(this).attr("id")){case"billing_country":o=e("#billing_kota"),s=e("#billing_city");break;case"shipping_country":o=e("#shipping_kota"),s=e("#shipping_city");break;case"calc_shipping_country":o=e("#calc_shipping_kota"),s=e("#calc_shipping_city");break;default:return!1}if("cart"===agenwebsite_woocommerce_jne_params.page){if("ID"!=p)return!1;e(e("#calc_shipping_state").parent()).after(i),e().select2?(t&&console.log("JNE Shipping: Change country and all script shipping state using select2"),e("select.country_to_state").select2(a),e("select#calc_shipping_state").select2(a)):e().chosen&&(t&&console.log("JNE Shipping: Change country and all script shipping state using chosen. Still using chosen?"),e("select.country_to_state").chosen(n),e("select#calc_shipping_state").chosen(n))}l={name:s.attr("name"),id:s.attr("id"),placeholder:s.attr("placeholder")},"ID"!==p&&((c=o.parent()).hide(),c.removeClass("form-row form-row-wide").addClass("form-row woocommerce-validated"),o.find("option").attr("value","default"),s.is("select")&&(s.parent().show().find(".chosen-container, .select2-container").remove(),s.replaceWith('<input type="text" class="input-text" name="'+l.name+'" id="'+l.id+'" placeholder="City" />')))}),e("body").on("updated_wc_div",function(){"cart"===agenwebsite_woocommerce_jne_params.page&&(e(e("#calc_shipping_state").parent().parent()).after(i),e().select2?(e("select.country_to_state").select2(a),e("select#calc_shipping_state").select2(a)):e().chosen&&(e("select.country_to_state").chosen(n),e("select#calc_shipping_state").chosen(n))),e("#calc_shipping_state").change()})});